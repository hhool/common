#include "StdAfx.h"
#include "../res/resource.h"

#include "about.h"

#pragma comment(lib,"WinInet")

const char* Common::c_about_dlg::about_str = 
"������Ϣ��\r\n"
"������漰����Ӳ���������п��ܻᱻɱ����������в������������ʹ�á�\r\n"
"��Ӧ�ó���Ϊ�������������ȡ�κη��ã���ʹ�ù������������ʻ򱨸��쳣������issue����\r\n"
"    https://github.com/KondeU/CommonSerialRelease    \r\n"
"�汾��Ϣ��2.02 [ANSI]\r\n"
"������(v1)��Ů�����ޣ�http://blog.twofei.com/566/��\r\n"
"������(v2)��KondeU��https://github.com/KondeU��\r\n"
"-----------------------------------------------------\r\n"
"����˵��:\r\n"
"    1.������C/C++����+Win32API��ʽ��д�������Ч��࣬��������κ�ϵͳ�����ļ���\r\n"
"    2.ʵ�ֶԴ��ڵĶ�ȡ��д�룬�ṩ16�������ַ���ʽ������ʾ��ʽ��\r\n"
"    3.֧���ļ������뱣�����ı���\r\n"
"    4.֧���Զ����ͣ��Զ��巢�����ڡ�\r\n"
"    5.�Զ�ʶ�����д��ڣ�����´��ڵĲ������Ѳ��봮�ڵ��Ƴ���\r\n"
"    6.֧��DTR/RTS���ŵ�ƽ���ơ�\r\n"
"    7.�ṩASCII���������ת��ʱ�ο���\r\n"
"    8.�ṩ����ش򿪼����������±����豸�������Ĺ�����ѡ�\r\n"
"    9.�����ַ�����ʱ���ṩ�ԡ�\\b�������ַ�֧�֡�\r\n"
"    10.�ṩ���λ��ƹ��ܣ����㶯̬���Ρ�\r\n"
"-----------------------------------------------------\r\n"
"����������\r\n"
"    ������ļ���С��1MB��1048576�ֽڣ�ʵ���ļ���С��\r\n"
"    ����������ı���С����������ļ���С��ͬ��\r\n"
"    ���ݽ�������������С��16�������ı��ַ�һ�£���10MB��\r\n"
//"    ֹͣ��ʾ��,�ڲ��������ݻ�������С��1MB��\r\n"
"    ����������ʱ,һ��������ȡ��С��1MB��\r\n"
"-----------------------------------------------------\r\n"
"ʹ�ð�����\r\n"
"    �����úô��ڵĲ�����Ȼ��򿪴��ڽ��ж�д��\r\n"
"    ���磬һ�����ã�ʵ�����Ӧ�ο�Ӳ������\r\n"
"        �����ʣ�9600\r\n"
"        У��λ����\r\n"
"        ����λ��8λ\r\n"
"        ֹͣλ��1λ\r\n"
"    �������Լ��ߵ��ٶ��շ�����ʱ����ֱ�ӹرմ��ڣ������п�����ɶ˿��޷��ͷţ������̻߳��޷������˳���\r\n"
"-----------------------------------------------------\r\n"
"������\r\n"
"    �Զ�����ʱ������Χ��50ms~60000ms��\r\n"
"    �����Զ����ͺ󽫲������ֶ����͡�\r\n"
"    ���޸ķ�������, �Զ����ͽ���ȡ����\r\n"
"    16���Ʒ��͸�ʽΪ��2��16����λ�����1���ո�\r\n"
"-----------------------------------------------------\r\n"
"����2�汾�����λ��ƹ��ܵ�ʹ�ã�\r\n"
"    ����ڴ������ƶ������������Ի����п�����ǰ��λ��״̬��\r\n"
"    CTRL+��������������/��������ѡ�С�\r\n"
"    CTRL+����Ҽ���������ƽ�ƴ�ֱ�ᣬ������ƽ�����̡�\r\n"
"    CTRL+�����ֿ���ʹ��ֱ��Ĳ�����������ȱ����ţ��ȱ�������С���̡�\r\n"
"    CTRL+SHIFT+�����ֿ��Ե���ˮƽ�������ͼ��ࡣ\r\n"
"    �ո��������ͣͼ�����о����ٰ�һ�μ�����ʾͼ����ͣʱ������Ȼ�ں�̨���ա�\r\n"
"    �������п����趨���ڴ�С�����Ƶ��С�������Լ��������͡�\r\n"
"    ֧�ֵ����������У�BYTE(1byte)��WORD(2bytes)��DWORD(4bytes)��FLOAT(4bytes)��DOUBLE(8bytes)��\r\n"
"    ��������Э�飺\r\n"
"        1.���ֽ����ݰ�С����ʽ���롣\r\n"
"        2.����ת���ַ�Ϊ0x66������λ����Ҫ���ͣ��������ֽ��գ����ֽ�Ϊ0x66ʱ����������������0x66��\r\n"
"        3.Ϊ�˱�֤�ֽ����׼ȷ�ԣ�Ҫ����λ������ÿ��һ����ʱ�����ڣ��ο�ʱ��ԼΪ1s���򴮿����ַ���0x66 0x01�����¶�������ֽ���\r\n"
"        4.����λ����Ҫֹͣ�������ֵĲ�����ʾ���ֲ�Ӱ�촮�������������ݵ������շ�ʱ�����򴮿����ַ���0x66 0x02��ֹͣ������ʾ�����յ�0x66 0x01ʱ�ٴο�����\r\n"
"         ��Ҳ���Խ�������ʾ���ڹرգ��رղ�����ʾ�����򲻽������������Ʋ���ͼ��\r\n"
"-----------------------------------------------------\r\n"
"����:\r\n"
"2012-12-24 1.0.0.0:\r\n"
"    ������1���汾\r\n"
"2012-12-26:\r\n"
"    �Զ�ʶ��ǰ����,����,�Ƴ��Ĵ��ں�\r\n"
"2013-01-11 1.0.0.1:\r\n"
"    ���ӱ�����������ݵ��ļ�(16����/�ı���ʽ)\r\n"
"    ���Ӵ��ļ������ݵ�������(16����/�ı���ʽ)\r\n"
"    ������ͣ��ʾ����\r\n"
"    ���Ӹ��Ʒ���/���������ݵ�������\r\n"
"2013-01-18 1.0.0.2:\r\n"
"    �޸�:�ı��ļ�,16�������ļ���ȡ����\r\n"
"    �޸�:�����ڲ�����������ʹ���������ѭ��\r\n"
"    �޸�:�ı��ַ���ʽ��ʾ���յ�����ʱ��������ȷ�Ļ��з��Ĵ���,��Ҫ�������з�, ��ʹ��\"\\n\"\r\n"
"2013-02-08 1.0.0.3:\r\n"
"    �ڲ���������������Ż�����,�������ݵķ��ͷ�ʽ��\r\n"
"    �޸���������ʱ����ڽ��������ı�ѡ����ɵĸ���\r\n"
"2013-02-14 1.0.0.4:\r\n"
"    ������ʾ��0~127��ASCII��Ӧ8,10,16���ƹ���\r\n"
"2013-02-24 1.0.0.5,����Ԫ����:\r\n"
"    ����ԭ����1~64�����б����Զ���������ϵĿ��ô���\r\n"
"2013-02-27 1.0.0.6:\r\n"
"    �������ı�,���Զ����ͱ��Զ�ȡ��(���Զ�����ѡ���Ѵ�)\r\n"
"    ����ʾģʽ�²������Խ��������ݽ���ѡ�����\r\n"
"    �ṩӲ��֧�ֵĴ����豸����\r\n"
"    Ϊ�û��ṩ���ڳ�ʱ����\r\n"
"    �ṩ�ֶ�����DTR/RTS���ŵ�ƽ\r\n"
"2013-03-01  1.0.0.7:\r\n"
"    �޸�ԭ������(ϵͳ)Ϊ����ʽ��ֵ������(�򵥰汾)\r\n"
"2013-03-03:\r\n"
"    ����:<����>�˵�����<�豸������>\r\n"
"    �޸�:�ڹرմ��ں��Զ�����ǰ��Ĺ������Զ�ȡ��(����Ѿ�ѡ��)\r\n"
"    �޸�:���ڱ��ر�/�Ƴ��󴮿��б��ص���һ�������豸��BUG\r\n"
"2013-03-04:\r\n"
"    �޸�:�����ڴ����б��п�����ʾ�������豸�������е�������\r\n"
"    ����:�޷���ʾ MSP430-FETUIF Debugger �Ĵ��ں�(���ڵ���SetupApi�����б�)\r\n"
"2013-03-05:\r\n"
"    Ϊ�˷������ݵ�ͳ������ʾ,16�����������ַ����ݱ���ʾ����ͬ�ı༭����\r\n"
"2013-03-09 1.0.0.8:\r\n"
"    ������ʹ��SetupApiö�ٴ����豸ʱδ��Ⲣ���豸����ɵ��ڴ��쳣���ʴ���\r\n"
"    ������ĳЩ������(��:19200bps)�¶������ص����(��:MSP430����),��ʱ���ǻᷢ��,�ȴ��޸�.ĳЩ����(��:SComAssistant"
"����ÿ��ֻ��һ���ֽڵİ취Ч������, �����ٶ��е���. �Ҹĳ���WaitCommEvent����������(ԭ����Pending ReadFile),������CPUռ��(��Щ����������������֧��ͬ������).\r\n"
"    ��ǰֻ��ReadFile+���nRead�ֽ�,�������,ReadFile������֤��ȡ��Ҫ�����������ŷ���,����ᵼ�����ض���,WriteFile��Ȼ.\r\n"
"    �ٶȼ���,�����ݸ�����\r\n"
"2013-03-10 1.0.0.9:\r\n"
"    ����:��Ϊ�ڸ�ʽ���ַ����������д��һ�� *pb = \'\\0\',���½�����������ʾ����!"
"    �޸�:��utils.hex2chs��add_text���˴����޸�,���������ݶ���,ò��û�ж���?,ϸ�ڴ����μ�Դ����\r\n"
"    1.0.0.8�汾��Ϊ�ڲ�ԭ���ٶ����ؼ���, 1.0.0.9�ص�ԭ���Ŀ���!\r\n"
"2013-03-18:\r\n"
"    ����:��Ϊ�ַ���ʾ��ʽ,16���Ʒ�ʽ���治������,��Ϊ��ʽ�����ϲ�����!\r\n"
"2013-03-23 1.10:\r\n"
"    ����:����ģʽ��,�Ҽ�����������ַ��ı������ʹ��������ʾģʽ(���Ƽ�),���������ַ��������ֽڹ���,����:һ����ĳһ�ν��չ�����ֻ"
"���յ��������ַ���һ���ֽ�,��ô���ݾͻ���ʾ����, ����޷�����, ���Խ��龡����ʹ��������ʾģʽ.\r\n"
"    ����:��C���Ե����Ƕ�ϰ��ʹ��'\\n'��Ϊ���з�,��Ҳ����ʹ��,"
"��ƫƫWindows�ı༭����'\\r\\n'��Ϊ���з�,û�а취,�Ҳ���"
"�������е�'\\n'����'\\r\\n',Ч�ʱ�Ȼ���½�,�����Ҳ��ò������"
"\\n�ĸ����� --> Ϊ�˼������軺�����Ĵ�С.\r\n"
"    ����:���ڿ�����ʾ����δ�����ͳ�ȥ�����ݼ���.\r\n"
"    ����:������ʱ��,�򿪴��ں�ʼ��ʱ,�رպ�ֹͣ��ʱ.\r\n"
"2013-03-25:\r\n"
"    ����:�������������������.ϸ�ڴ���������.����Ӧ�ÿ��Է��ĵ�ʹ��������ʾģʽ��.\r\n"
"    ����:�ַ���ת16�������鹦��,���߲˵�����.\r\n"
"2013-04-04:\r\n"
"    ����:�޷����ƽ������ַ��ı���BUG.\r\n"
"    С��ʾ:��ѡ�񴮿�ʱ,���û���κο��õĴ���,�������ʾ����.\r\n"
"2013-04-07:\r\n"
"    �޸�:��ȫ�޸���utils.str2hex��ʵ��,���������16��������������.\r\n"
"���ڵ�Ҫ��:ÿ��16����ֵ�����������ַ����,����������.(��ǰ��2�������ַ�+һ���ո�)\r\n"
"2013-04-11:\r\n"
"    �����ַ�����ʱ,���ڻ���,ֻ����\'\\n\',���ٷ���\'\\r\\n\',ע��:��β��\'\\0\\\'��������!\r\n"
"2013-04-13:\r\n"
"    ����:���ķ�������շ�ʽΪ�첽��ʽ.\r\n"
"    ����:��ͼ����ʾ.\r\n"
"2013-04-23:\r\n"
"    ����:��������շ�ʽ�Ļ�ͬ����ʽ!��~\r\n"
"    ����:�����Ͳ����ﵽ100��ʱ�޷��������͵�BUG!\r\n"
"    �޸�:�Ż��ڲ��߳�ͬ������,�������ֹͣ����(ʧȥ��Ӧ)!\r\n"
"    �Ż�:�Ż��Զ��������ݵķ�ʽ,��߾���,��С�ڴ�/CPUռ��!\r\n"
"    С��ʾ:�ڼ���/�����ļ�ʱ,���������/���淽ʽ,���Բ鿴�򵥵İ�����Ϣ!\r\n"
"2013-05-11:����ĸ�׽�\r\n"
"    ����:�����ҵ�һ���ȽϺõİ취�������Զ������õ����ظ�������,�Ǻ�,ʱ�����޼��ٵ�10ms\r\n"
"2013-07-05:\r\n"
"    ��ʱ����:ѡ����ļ����ز�ȡ����, ���ں�ѡ���ComboBox����ʧ����,��֪��ԭ��,��ʱ�ѽ��\r\n"
"2013-07-14:\r\n"
"    �Ľ�:�����ڲ��Ľ��ڴ�����㷨,����������������ڴ�й©\r\n"
"2013-07-20 1.12:\r\n"
"    (���ɰ汾,�Ժ����)\r\n"
"2013-07-27:\r\n"
"    ϸ��:��������С���������Ӵ��ڲ��Զ���С��������\r\n"
"2013-08-29:\r\n"
"    ����:���豸�������и��Ĵ��ڵĶ˿ںź�, �Զ�ˢ�´����б�\r\n"
"    ϸ��:�����ڴ��ڴ���������ʾ���յ�������ʱ�޷�ʹ�������ֵ�С����\r\n"
"2013-08-30:\r\n"
"    ϸ��:�����û�Ҫ��,���ڴ�С���ڿ��Ա仯; ����������ڽ���/���������ı����С, ���������϶������Ըı䴰�ڴ�С\r\n"
"    ϸ��:����ԭ��������û��ˮƽ������,�������ݿ����Զ�������, �����Ѿ���,���ݲ����Զ�����, Ҫ����, ��ʹ�� \'\\n\'\r\n"
"2013-09-10 1.13:\r\n"
"    ����:���ڿ����ֶ���д�����͵������ļ�,������������ - �ڷ����ļ�ʱѡ�� �����ļ�, ��ʽ�����ͺ���Ľ���\r\n"
"    ����:�ַ�����ģʽ��,����ѡ��ȡ���س����з��ķ���,����ѡ�����ת���ַ�\r\n"
"        1.֧�ֵ��ַ���ת���ַ�:\r\n"
"            \\r,\\n,\\t,\\v,\\a,\\b,\\\\\r\n"
"        2.֧�ֵ�16����ת���ַ���ʽ:\r\n"
"            \\x?? - ����һ���ʺŴ���һ��16�����ַ�, ����ʡ����һ,\r\n"
"            ���豣֤4���ַ��ĸ�ʽ\r\n"
"        3.\'\?\',\'\'\',\'\"\', ��print-able�ַ�����Ҫת��\r\n"
"2013-11-02 1.14:\r\n"
"    �޸�:��ȫ�޸�������͵Ľ���,��ԭ�������˺ܶ�~\r\n"
"2013-11-06:\r\n"
"    ����:������ջ�������δ��ʾ������,����ڰ��¼�����ʾʱ������ʾ,������ԭ�����ڽ��յ���һ�ε�����ʱ������ʾ;��л����lin0119�ķ���\r\n"
"2014-03-03: 1.15\r\n"
"    ����:֧������Ǳ�׼�Ĳ�����, ���������Ƿ��ܹ�֧��, Ҫ�������������\r\n"
"    �Ľ�:������һЩ��ݼ�, ����Alt+SΪ����...\r\n"
"2014-07-05: 1.16\r\n"
"    ���ַ���������ʱ,���ӶԿ����ַ�Backspace��֧��(��'\b'),Ч��������ǰɾ��һ���ַ�\r\n"
"    ���޸�һ�����ļ�����(ԭ���ǶԵ�, ��֪��ʲôʱ��Ĵ���\r\n"
"    ��ɾ���˴����С����(�¸��汾����ʹ���Զ�����)\r\n"
"2014-07-06: 1.17\r\n"
"    ������:�����ӽ����������ַ�������(���Ѻõ��ཻ��ģʽ)\r\n"
"    �ڸ���:�������ַ�������/������������ΪConsolas�ȿ�����,����ʹ��ԭ����Courier����\r\n"
"    ������:���ģʽ - ��ģʽ�´󲿷ֽ���Ԫ�ػᱻ����, ��ʱ�����������\r\n"
"    ������:�����ڵ��Զ����沼��(�����϶��ı䴰�ڴ�С,�ؼ������Զ�����)\r\n"
"    �ݸ���:Ĭ��ʹ�õ�ģʽ��Ϊ:�ַ�����+�ַ�����\r\n"
"2014-08-09: 1.18 Beta\r\n"
"    �Ż�:�򻯶������а���'\\0'�����ݵĴ���\r\n"
"    ����:������ģʽʱ�ѹ������ŵ����\r\n"
"    ����:����������һ��\"�������\"�˵�\r\n"
"    ����:�����ƽ������ݵĶ���\r\n"
"    �Ż�:����ʵ��4�ֻ��з���ͳһ, ����'\\r\\n'�����η���Ҳ����ȷ�ز�����һ�����з�!\r\n"
"    �Ż�:������Ӧ���µĲ��ַ���\r\n"
"    �޸�:�޸��������16����ת���ַ�����\r\n"
"    �޸�:���һ�������ַ������η��͵���������\r\n"
"2015-08-02: 1.19 ��Υ��\r\n"
"    �޸���\"���浽�ļ�\"����\r\n"
"    ����޷�ʶ�����⴮�ڵ����� && ���ĳЩ��֧�ֵ��¼�����SetCommMaskʧ������\r\n"
"    �༭�����ӳ��ù���:����м�ɾ��,������\r\n"
"    ȥ����һЩ����Ҫ�Ĺ���libtccw32,str2hex,pinctrl\r\n"
"2015-09-13: 1.20 û��ʲô�޸�,ֻ���������ĵ�\r\n"
"    û��ʲôʵ���Ե��޸�,�������ĵ�,������idxml��tinyxml���߿�\r\n"
"-----------------------------------------------------\r\n"
"����:\r\n"
"2017-11-17: 2.01 �����Ȩ������ԭ���ߵĴ������Ӳ��λ��ƹ��ܣ������汾��\r\n"
"    ԭ�����к��е�ʵ��û��ʵ�ֻ����Ƴ��Ĺ����У���ʱ���á������ṩ�����á������մ�����ͣ��ʾ����״���ơ������������ˡ��ַ���ת16���ơ���������°汾��\r\n"
"    �޸��˲��ִ��뼰ͼ�꣬�����˲��λ��ƵĹ��ܡ�\r\n"
"-----------------------------------------------------\r\n"
"����:\r\n"
"2021-08-26: v1�汾master���и��£�ͬ�����µ�v2\r\n"
"    [2015-12-28] fix issue: ����DTR/RTS���ŵ�ƽ����\r\n"
"\r\n\r\n";

namespace Common{
	LRESULT c_about_dlg::handle_message(UINT uMsg, WPARAM wParam, LPARAM lParam, bool& bHandled)
	{
		switch (uMsg)
		{
		case WM_INITDIALOG:
		{
			SetWindowText(m_hWnd, "���� " COMMON_NAME_AND_VERSION);
			SetWindowText(*_layout.FindControl("stk_name"), COMMON_NAME_AND_VERSION "  ����ʱ��:" __DATE__ " - " __TIME__);
			SetWindowText(*_layout.FindControl("edit_help"), about_str);
			SetFocus(*_layout.FindControl("btn_website"));
			CenterWindow();
			return 0;
		}
		case WM_PAINT:
		{
			PAINTSTRUCT ps;
			HICON hIcon;
			HDC hDC = BeginPaint(m_hWnd, &ps);
			hIcon = LoadIcon(theApp.instance(), MAKEINTRESOURCE(IDI_ICON1));
			DrawIcon(hDC, 10, 10, hIcon);
			EndPaint(m_hWnd, &ps);
			DestroyIcon(hIcon);
			return 0;
		}
		case WM_CLOSE:
			break;
		}
		return __super::handle_message(uMsg, wParam, lParam, bHandled);
	}

	LPCTSTR c_about_dlg::get_skin_xml() const
	{
		return 
R"feifei(
<Window size="420,450">
	<Font name = "΢���ź�" size = "12" default = "true" />
	<Vertical>
		<Vertical inset = "5,5,5,5">
			<Horizontal height="50" inset="0,0,0,0">
				<Control width="45" />
				<Vertical inset="0,0,0,5">
					<Static name="stk_name" height="20"/>
					<Static text="Ů������ ��ʼ�� 2012-12-24 ƽ��ҹ" height="20"/>
					<Static text="KondeU ��ʼ�� 2017-11-17" height="20"/>
				</Vertical>
			</Horizontal>
			<Edit style="readonly,multiline,hscroll,vscroll" exstyle="clientedge" name="edit_help" inset="0,5,0,5" minheight="300"/>
			<Horizontal height="30" inset="0,5,0,0">
				<Control />
				<Button name="btn_website" text="v2.02��Դ��ַ" width="100" />
				<Control width="10" />
				<Button name="btn_ok" text="v1.20��Դ��ַ" width="100" />
				<Control />
			</Horizontal>
		</Vertical>
	</Vertical>
</Window>
)feifei";
	}

	LRESULT c_about_dlg::on_command_ctrl(HWND hwnd, SdkLayout::CControlUI* ctrl, int code)
	{
		auto& name = ctrl->GetName();
		if (name == "btn_website"){
			if (code == BN_CLICKED){
                char* web = "https://github.com/KondeU/CommonSerial";
                ShellExecute(NULL, "open", web, NULL, NULL, SW_SHOWNORMAL);
				return 0;
			}
		}
		else if (name == "btn_ok"){
			if (code == BN_CLICKED){
                char* web = "https://github.com/movsb/common";
                ShellExecute(NULL, "open", web, NULL, NULL, SW_SHOWNORMAL);
				return 0;
			}
		}

		return 0;
	}

	LPCTSTR c_about_dlg::get_window_name() const
	{
		return "����" " " COMMON_NAME_AND_VERSION;
	}

	const char* c_about_dlg::soft_name = COMMON_NAME_AND_VERSION ;

}
